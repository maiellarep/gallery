{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\internship\\\\gallery\\\\src\\\\EditImg.js\";\nimport React from 'react';\nimport './css/CollectionsPage.css';\nimport IndexedDbRepository from './IndexedRepository';\n\nclass EditImg extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleImageChange = this.handleImageChange.bind(this);\n    this.state = {\n      obj: null\n    };\n\n    this.handleAdd = async () => {\n      await this.repository.save({\n        image: this.state.image,\n        name: this.state.name,\n        description: this.state.description,\n        format: this.state.format,\n        mimetype: this.state.mimetype,\n        weight: this.state.weight,\n        size: this.state.size,\n        collection: this.state.collection\n      });\n      this.setState({\n        tasks: null\n      });\n      this.setState({\n        tasks: await this.repository.findAll()\n      });\n      console.log(this.state.tasks);\n    };\n  }\n\n  componentDidMount() {\n    this.repository = new IndexedDbRepository(); //this.repository.findAll().then( tasks => this.setState( { tasks } ) );\n\n    this.repository.findById(parseInt(this.props.match.params.id)).then(obj => this.setState({\n      obj\n    })); //this.repository.findById(this.props.match.params.id).then(obj => this.setState({obj}));\n  }\n\n  handleChange(e) {\n    this.setState({\n      [e.target.name]: e.target.value\n    });\n  }\n\n  handleImageChange(e) {\n    var file = e.target.files[0];\n    this.setState({\n      mimetype: '.' + file.type.split('/')[1],\n      weight: (file.size / 1024 / 1024).toFixed(2) + \" МБ\"\n    });\n    console.log(file);\n    var reader = new FileReader();\n    console.log(reader);\n    var preview = document.getElementById(\"preview\");\n    reader.readAsBinaryString(file);\n\n    reader.onload = function (e) {\n      let bits = e.target.result;\n      preview.src = 'data:image/jpeg;base64,' + btoa(bits);\n      var img = new Image();\n      img.src = 'data:image/jpeg;base64,' + btoa(bits);\n\n      img.onload = () => {\n        var size = img.height + \"X\" + img.width + \" px\";\n        this.setState({\n          image: bits,\n          size: size\n        });\n      };\n    }.bind(this);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }\n    }, \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"), /*#__PURE__*/React.createElement(\"img\", {\n      width: \"300px\",\n      id: \"preview\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 46\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      name: \"image\",\n      onChange: this.handleImageChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 80\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      id: \"name\",\n      class: \"input_1\",\n      name: \"name\",\n      type: \"text\",\n      value: this.state.obj.name,\n      onChange: this.handleChange,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 137\n      }\n    }), /*#__PURE__*/React.createElement(\"select\", {\n      name: \"format\",\n      value: \"\\u0410\\u043B\\u044C\\u0431\\u043E\\u043C\",\n      onChange: this.handleChange,\n      onLoad: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 106\n      }\n    }), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\\u0410\\u043B\\u044C\\u0431\\u043E\\u043C\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }\n    }, \"\\u0410\\u043B\\u044C\\u0431\\u043E\\u043C\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\\u041F\\u043E\\u0440\\u0442\\u0440\\u0435\\u0442\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }\n    }, \"\\u041F\\u043E\\u0440\\u0442\\u0440\\u0435\\u0442\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\\u041A\\u0432\\u0430\\u0434\\u0440\\u0430\\u0442\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }\n    }, \"\\u041A\\u0432\\u0430\\u0434\\u0440\\u0430\\u0442\")), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 22\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      id: \"description\",\n      class: \"input_1\",\n      name: \"description\",\n      type: \"text\",\n      value: this.state.description,\n      onChange: this.handleChange,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 154\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      id: \"collection\",\n      class: \"input_1\",\n      name: \"collection\",\n      type: \"text\",\n      value: this.state.collection,\n      onChange: this.handleChange,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 151\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      class: \"btn green\",\n      onClick: this.handleAdd,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 13\n      }\n    }, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"));\n  }\n\n}\n\nexport default EditImg;","map":{"version":3,"sources":["C:/Users/User/Desktop/internship/gallery/src/EditImg.js"],"names":["React","IndexedDbRepository","EditImg","Component","constructor","props","handleChange","bind","handleImageChange","state","obj","handleAdd","repository","save","image","name","description","format","mimetype","weight","size","collection","setState","tasks","findAll","console","log","componentDidMount","findById","parseInt","match","params","id","then","e","target","value","file","files","type","split","toFixed","reader","FileReader","preview","document","getElementById","readAsBinaryString","onload","bits","result","src","btoa","img","Image","height","width","render"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport './css/CollectionsPage.css';\r\nimport IndexedDbRepository from './IndexedRepository';\r\n\r\nclass EditImg extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleImageChange = this.handleImageChange.bind(this);\r\n        this.state = {\r\n            obj: null,\r\n        }\r\n\r\n        this.handleAdd = async() => {\r\n\r\n            await this.repository.save( { image: this.state.image, \r\n                                            name: this.state.name, \r\n                                            description: this.state.description, \r\n                                            format: this.state.format,\r\n                                            mimetype: this.state.mimetype,\r\n                                            weight: this.state.weight,\r\n                                            size: this.state.size,\r\n                                            collection: this.state.collection}\r\n                                             );\r\n            this.setState( { tasks: null } );\r\n            this.setState( { tasks: await this.repository.findAll() } );\r\n            console.log(this.state.tasks);\r\n          };\r\n\r\n    }\r\n    componentDidMount() {\r\n       \r\n        this.repository = new IndexedDbRepository();\r\n        //this.repository.findAll().then( tasks => this.setState( { tasks } ) );\r\n        this.repository.findById(parseInt(this.props.match.params.id)).then( obj => this.setState( { obj } ) );\r\n        //this.repository.findById(this.props.match.params.id).then(obj => this.setState({obj}));\r\n    }\r\n\r\n    handleChange(e) {\r\n        this.setState({[e.target.name]: e.target.value});\r\n    }\r\n\r\n    handleImageChange(e) {\r\n        var file = e.target.files[0];\r\n        this.setState({\r\n            mimetype: '.' + file.type.split('/')[1],\r\n            weight: (file.size/1024/1024).toFixed(2) + \" МБ\"\r\n        });\r\n\r\n        console.log(file);\r\n        var reader = new FileReader();\r\n        console.log(reader);\r\n        var preview = document.getElementById(\"preview\");\r\n        reader.readAsBinaryString(file);\r\n        \r\n\t\t\t\treader.onload = function(e) {\r\n                    let bits = e.target.result;\r\n                    preview.src = 'data:image/jpeg;base64,' + btoa(bits);\r\n                    var img = new Image();\r\n                    img.src = 'data:image/jpeg;base64,' + btoa(bits);\r\n                    img.onload = () => {\r\n                        \r\n                    var size = img.height + \"X\" + img.width + \" px\";\r\n                        this.setState({\r\n                            image: bits,\r\n                            size: size\r\n                        });\r\n                    }\r\n                    \r\n                }.bind(this);\r\n\r\n    }\r\n\r\n\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n            <h1>Редактирование</h1>\r\n            <img width=\"300px\" id=\"preview\"/><br/>\r\n            <input type=\"file\" name=\"image\" onChange={this.handleImageChange}/><br/>\r\n            <input id=\"name\" class=\"input_1\" name=\"name\" type=\"text\" value={this.state.obj.name} onChange={this.handleChange} required/><br/>\r\n            <select name=\"format\" value=\"Альбом\" onChange={this.handleChange} onLoad={this.handleChange}><br/>\r\n                <option value=\"Альбом\">Альбом</option>\r\n                <option value=\"Портрет\">Портрет</option>\r\n                <option value=\"Квадрат\">Квадрат</option>\r\n            </select><br/>\r\n            <input id=\"description\" class=\"input_1\" name=\"description\" type=\"text\" value={this.state.description} onChange={this.handleChange} required/><br/>\r\n            <input id=\"collection\" class=\"input_1\" name=\"collection\" type=\"text\" value={this.state.collection} onChange={this.handleChange} required/><br/>\r\n            <button type=\"button\" class=\"btn green\" onClick={this.handleAdd}>Добавить</button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nexport default EditImg;"]},"metadata":{},"sourceType":"module"}