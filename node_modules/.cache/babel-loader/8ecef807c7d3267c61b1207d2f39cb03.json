{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\internship\\\\new\\\\gallery\\\\src\\\\CollectionsPage.js\";\nimport React from 'react';\nimport './css/CollectionsPage.css';\nimport './css/common.css';\nimport './css/Buttons.css';\nimport IndexedDbRepository from './IndexedRepository';\nimport { Link } from 'react-router-dom';\n\nclass CollectionsPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      collections: []\n    };\n\n    this.handleDelete = async idToDelete => {\n      var colImg = await this.repository.searchByField('photos', 'collections', idToDelete);\n\n      if (window.confirm('Удалить также и изображения коллекции?')) {\n        for (const element of colImg) {\n          await this.repository.deleteById('photos', element.id);\n        }\n      } else {\n        for (const element of colImg) {\n          element.collection = 'Другое';\n          await this.repository.save('photos', element);\n        }\n      }\n\n      await this.repository.deleteById('collections', idToDelete);\n      this.setState({\n        collections: await this.repository.findAll('collections')\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.repository = new IndexedDbRepository(\"id\");\n    this.repository.findAll('collections').then(collections => this.setState({\n      collections\n    }));\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      class: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"photo-wall\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 21\n      }\n    }, this.state.collections.map(collectiondata => {\n      return /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        class: \"post\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: /collectionpage/ + collectiondata.colName,\n        class: \"btnlink\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        width: \"200px\",\n        height: \"100px\",\n        src: 'data:image/jpeg;base64,' + btoa(collectiondata.colPreview),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 33\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 33\n        }\n      }, collectiondata.colName)), /*#__PURE__*/React.createElement(\"button\", {\n        class: \"button\",\n        type: \"button\",\n        onClick: async () => {\n          await this.handleDelete(collectiondata.colName);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 33\n        }\n      }, \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\")));\n    }))), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: \"/addcollection\",\n      class: \"btnlink\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 41\n      }\n    }, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043A\\u043E\\u043B\\u043B\\u0435\\u043A\\u0446\\u0438\\u044E\")));\n  }\n\n}\n\nexport default CollectionsPage;","map":{"version":3,"sources":["C:/Users/User/Desktop/internship/new/gallery/src/CollectionsPage.js"],"names":["React","IndexedDbRepository","Link","CollectionsPage","Component","constructor","props","state","collections","handleDelete","idToDelete","colImg","repository","searchByField","window","confirm","element","deleteById","id","collection","save","setState","findAll","componentDidMount","then","render","map","collectiondata","colName","btoa","colPreview"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport './css/CollectionsPage.css';\r\nimport './css/common.css';\r\nimport './css/Buttons.css';\r\nimport IndexedDbRepository from './IndexedRepository';\r\nimport {Link} from 'react-router-dom';\r\n\r\nclass CollectionsPage extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            collections: []\r\n        }\r\n\r\n        this.handleDelete = async( idToDelete ) => {\r\n            var colImg = await this.repository.searchByField('photos', 'collections', idToDelete);\r\n            if(window.confirm('Удалить также и изображения коллекции?'))\r\n            {\r\n                for (const element of colImg) {\r\n                    await this.repository.deleteById( 'photos', element.id );\r\n                }\r\n            }\r\n            else\r\n            {\r\n                for (const element of colImg) {\r\n                    element.collection = 'Другое';\r\n                    await this.repository.save( 'photos', element);\r\n                }\r\n            }\r\n            await this.repository.deleteById( 'collections', idToDelete );\r\n            this.setState( { collections: await this.repository.findAll('collections') } );\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.repository = new IndexedDbRepository(\"id\");\r\n        this.repository.findAll('collections').then( collections => this.setState( { collections } ) );\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div class=\"container\">\r\n                <div id=\"photo-wall\">\r\n                    <ul>\r\n                    {this.state.collections.map((collectiondata) => {\r\n                            return (\r\n                                <li>\r\n                                <div class=\"post\">\r\n                                <Link to={/collectionpage/+ collectiondata.colName} class=\"btnlink\" >\r\n                                <img width = \"200px\" height = \"100px\" src = {'data:image/jpeg;base64,' + btoa(collectiondata.colPreview)}/>\r\n                                <p>{collectiondata.colName}</p></Link>\r\n                                <button class = \"button\" type = \"button\" onClick = {async () => {await this.handleDelete(collectiondata.colName)}}>Удалить</button>\r\n                                </div>\r\n                                </li>\r\n                            );\r\n                    \r\n                    })}   \r\n                    </ul>\r\n                </div>\r\n                <button type = \"button\"><Link to='/addcollection' class=\"btnlink\" >Добавить коллекцию</Link></button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default CollectionsPage;"]},"metadata":{},"sourceType":"module"}